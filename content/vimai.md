+++
title = "راه‌اندازی هوش مصنوعی محلی در ویم با ollama"
description = "هوش مصنوعی در ویم؟"
date=1404-04-07
category = "ویم"
[taxonomies]
tags = ["ویم"]

[extra]
author="سهراب بهدانی"
+++

بعد از مدتی گفتم بیام توی این بلاگ یک مطلب جدید بنویسم، الان داشتم مدل qwen3-coder رو دریافت می‌کردم و گفتم با خودم که جالب میشه یک آموزش متنی بنویسم و نحوه استفاده از این مدل رو داخل ویم بدم.

راه‌اندازی این‌ها رو که داخل vscode و zed شاید همه بتونین انجام بدید، ولی درمورد ویم (نئوویم نه) یکمی داستان داره که من حالا می‌خوام به یک صورت ساده آموزشش رو بنویسم شاید بدردتون بخوره :)

<!-- more -->

# شروع به کار

خب از اونجایی که من از [پارچ](https://parchlinux.com) استفاده می‌کنم (که یک توزیع برپایه آرچ هستش) طبیعتاً دستوراتی که برای نصب بسته استفاده می‌کنم با پک‌من هستش، بنابراین اگر شما توزیع دیگه‌ای استفاده می‌کنید حتماً مدیربسته اون توزیع رو استفاده کنید :) (کورکورانه کپی پیست نکنید چیزی رو).

خب برای شروع باید چندتا چیز میز رو نصب کنیم، که حالا متشکل هستند از گیت و ویم و سایر وابستگان مربوطه.

```bash
sudo pacman -S vim git base-devel
```

بعد از نصب این‌ها، باید بریم و [VimPlug](https://github.com/junegunn/vim-plug) رو نصب کنیم. (فکر بد نکنید مدیربسته افزونه‌های ویم هستش)

برای نصب سریع این مدیرافزونه یا مدیربسته، باید این دستور رو وارد کنید:
```bash
curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
```

این دستور مدیرافزونه رو دریافت و در مسیر مربوطه نصب می‌کنه، دستی هم طبق صفحه گیتش که بالا لیست کردم می‌تونید انجامش بدید.

بعد از نصبش، فایل پیکربندی ویم رو باید باز کنیم و ویرایشش کنیم.
```bash
vim ~/.vimrc
```

و داخلش این بند رو بنویسیم که ویم‌پلاگ رو صدا می‌زنه. از الان هر افزونه‌ای که بخوایم نصب کنیم باید داخل همین سکشن بنویسیمش.

```vim
call plug#begin()

" List your plugins here
Plug 'tpope/vim-sensible'

call plug#end()
```

بعد از وارد کردن این، فایل رو ذخیره می‌کنیم و ویم رو باز می‌کنیم و بعدش با وارد کردن
```
:PlugInstall
```
افزونه‌هایی که تنظیم کردیم نصب میشن.

## نصب کودا، اولاما و اولاما کودا (اگر انویدیا هستید)

خب اگر درایور انویدیاتون رو نصب کردید و گرافیکتون از کودا پشتیبانی می‌کنه، میتونیم شروع کنیم به نصب کردنش.
یادتون باشه که در این فرآیند با توجه به سرعت اینترنتتون بین ۱ تا ۱۰ لیوان قهوه می‌تونید مصرف کنید. (حدود ۵ گیگ حداقل دانلود دارید)

```bash
sudo pacman -S ollama ollama-cuda cuda cudnn
```
اگر انویدیا ندارید میتونید از نصب کودا صرف‌نظر کنید و صرفاً خود اولاما رو بگیرید.

و بعدش مدل رو با این دستور دریافت می‌کنیم:
```bash
ollama serve
ollama pull kirito1/qwen3-coder
```
این فرآیند ۲ گیگ حجم مصرف می‌کنه. اگر با خطا مواجه شدید باید بندازینش پشت پروکسی. از هر مدل دیگه‌ای هم که خواستید میتونید استفاده کنید.

بعد از دریافت این‌ها وارد مرحله بعدی می‌شیم.

## نصب افزونه هوش مصنوعی روی ویم

اول از همه چون این افزونه با پایتون کار می‌کنه نیاز داریم چندتا کتابخونه رو نصب کنیم:
```bash
sudo pacman -S python-requests python-jinja python-httpx
```

دوباره فایل پیکربندی ویم رو باز می‌کنیم و این بخش رو داخلش می‌نویسیم:
```
Plug 'gergap/vim-ollama'
```
و بعد از ذخیره با دستور PlugInstall افزونه رو نصب می‌کنیم.

الان باید بریم سراغ پیکربندی خود افزونه
آخر همین فایل شروع می‌کنیم به نوشتن پیکربندی این افزونه:
```
let g:ollama_host = 'http://localhost:11434'
let g:ollama_chat_model = 'llama3.2:1b'
let g:ollama_model = 'qwen3-coder'
let g:ollama_edit_model = 'qwen3-coder'
```
داخل chatmodel شما می‌توانید از هر مدل دیگه‌ای که خواستید استفاده کنید. که من از llama3.2:1b استفاده می‌کنم.
بعد از ذخیره این فایل، می‌تونیم شروع کنیم.

## شروع به استفاده

خب برای شروع اول باید ollama رو اجرا کنیم.
```bash
ollama serve
```

بعدش ویم رو باز می‌کنیم و شروع می‌کنیم به کد نوشتن.

- متن‌ها به صورت شبح‌گونه ظاهر میشن که با ```tab``` می‌تونیم تایید کنیم. همینطور با فشردن کلید `<C-]>` می‌تونیم پیشنهاد رو رد کنیم.
- اگر کل پیشنهاد رو نمی‌خوایم با کلید `<M-Right>` و یا اگر یک کلمه از اون `<M-C-Right>` رو بپذیریم.

اگر نفهمیدید اشکالی نداره این پایین توضیح دادم:
---
### توضیح این کلید‌ها در ویم

از اونجایی که شاید آشنایی نداشته باشید یک سری توضیح می‌نویسم که اینا چی هستن.
در هر آموزشی از ویم C رو داخل میانبرها دیدید به معنی کلید کنترل هستش CTRL و هرجا M رو دیدید به معنی Meta هستش که معمولاً به Alt بایند شده.

حالا با توضیحات بالا `<M-C-Right>` یعنی فشردن کلید کنترل + آلت و جهت راست کیبورد.



{{ comments(id="114760841885663652") }}


<div>
<meta name="fediverse:creator" content="@sohrab@bsd.cafe">
</div>
